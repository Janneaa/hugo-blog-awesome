{{ with .Get "src" }}
  {{ $image := resources.Get . }}
  {{ $width := $.Get "width" }}
  {{ $webp := $image.Process "webp" }}
  {{ $processed := $webp.Resize (printf "%sx" $width) }}
  <a href="{{ $image.Permalink }}" target="_blank" class="image-link" style="width: {{ $width }}px">
    <img src="{{ $processed.Permalink }}" alt="{{ $.Get "alt" }}" {{ with $.Get "class" }}class="{{ . }}"{{ end }} loading="lazy" />
  </a>
{{ end }}